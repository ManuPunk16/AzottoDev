<div class="relative inline-block">
    <!-- Main CV Button -->
    <button 
        #buttonElement
        (click)="toggleDropdown()" 
        [@buttonPulse]="pulseState" 
        class="group flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-blue-500 to-blue-600 
               text-white rounded-xl font-semibold shadow-lg hover:shadow-xl 
               transform hover:scale-105 transition-all duration-300 relative overflow-hidden
               hover:from-blue-600 hover:to-blue-700"
        [class.ring-4]="isDropdownOpen" 
        [class.ring-blue-300]="isDropdownOpen">

        <!-- Background gradient animation -->
        <div class="absolute inset-0 bg-gradient-to-r from-blue-600 to-blue-700 
                    opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>

        <!-- Content -->
        <div class="relative z-10 flex items-center gap-3">
            <svg class="w-5 h-5 group-hover:rotate-12 transition-transform duration-300" 
                 fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>

            <span>Descargar CV</span>

            <svg class="w-4 h-4 transition-transform duration-300" 
                 [class.rotate-180]="isDropdownOpen" 
                 fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
        </div>
    </button>
</div>

<ng-template #dropdownTemplate>
    <div 
        [@dropdownAnimation]="isDropdownOpen ? 'open' : 'closed'" 
        class="w-80 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden">

        <!-- Header -->
        <div class="px-6 py-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-700 dark:to-gray-600 
                    border-b border-gray-200 dark:border-gray-600">
            <h3 class="text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2">
                <svg class="w-5 h-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9" />
                </svg>
                Selecciona el idioma
            </h3>
            <p class="text-xs text-gray-600 dark:text-gray-300 mt-1">
                Elige la versi√≥n de tu preferencia
            </p>
        </div>

        <!-- CV Options -->
        <div class="p-3">
            @for (option of cvOptions; track option.lang) {
            <button (click)="selectCV(option)" 
                    class="w-full flex items-center gap-4 p-4 mb-2 last:mb-0 text-left 
                           rounded-xl border-2 border-transparent
                           hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-gray-700/50
                           transition-all duration-300 transform hover:scale-[1.02] hover:shadow-md
                           bg-gray-50 dark:bg-gray-700/30 group">

                <!-- Flag -->
                <div class="flex-shrink-0 w-16 h-16 rounded-xl bg-white dark:bg-gray-600 
                            shadow-md flex items-center justify-center
                            transform group-hover:scale-110 transition-transform duration-300">
                    <span class="text-4xl">{{ option.flag }}</span>
                </div>

                <!-- Content -->
                <div class="flex-1 min-w-0">
                    <h4 class="font-bold text-gray-800 dark:text-white text-base mb-1">
                        {{ option.label }}
                    </h4>
                    <p class="text-xs text-gray-500 dark:text-gray-400">
                        {{ option.description }}
                    </p>
                </div>

                <!-- Download icon -->
                <svg class="w-6 h-6 text-gray-400 group-hover:text-blue-500 dark:group-hover:text-blue-400
                          opacity-0 group-hover:opacity-100 transform group-hover:translate-x-1
                          transition-all duration-300 flex-shrink-0" 
                     fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
            </button>
            }
        </div>

        <!-- View Online Option -->
        <div class="border-t border-gray-200 dark:border-gray-600 p-3">
            <button (click)="viewOnline()" 
                    class="w-full flex items-center justify-center gap-3 px-4 py-3.5 text-sm font-semibold
                           bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl
                           hover:from-blue-600 hover:to-purple-700 
                           transition-all duration-300 transform hover:scale-[1.02] hover:shadow-lg">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
                Ver CV Online
            </button>
        </div>
    </div>
</ng-template>

<!-- Backdrop -->
@if (isDropdownOpen) {
<div class="fixed inset-0 z-40" (click)="closeDropdown()"></div>
}